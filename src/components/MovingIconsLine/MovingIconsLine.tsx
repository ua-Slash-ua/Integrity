'use client'

import { JSX, useEffect, useRef } from 'react'
import styles from './MovingIconsLine.module.css'

const icons = ['meta', 'adwords', 'linkedin', 'tiktok']

const MovingIconsLine = ({ className }: { className?: string }) => {
  const pathRef = useRef<SVGPathElement | null>(null)
  const iconRefs = useRef<HTMLDivElement[]>([])

  const iconMap: Record<string, JSX.Element> = {
    tiktok,
    adwords,
    meta,
    linkedin,
  }

  useEffect(() => {
    if (!pathRef.current) return
    const path = pathRef.current
    const pathLength = path.getTotalLength()

    const iconCount = icons.length
    const offsets = Array.from({ length: iconCount }, (_, i) => (i * pathLength) / iconCount)
    const speed = 4 // px per frame
    let frameId: number

    const animate = () => {
      iconRefs.current.forEach((icon, i) => {
        offsets[i] = (offsets[i] + speed) % pathLength
        const point = path.getPointAtLength(offsets[i])
        const nextPoint = path.getPointAtLength((offsets[i] + 1) % pathLength)

        const angle = Math.atan2(nextPoint.y - point.y, nextPoint.x - point.x)

        icon.style.transform = `translate(${point.x}px, ${point.y}px) rotate(${angle}rad)`
      })
      frameId = requestAnimationFrame(animate)
    }

    animate()
    return () => cancelAnimationFrame(frameId)
  }, [])

  return (
    <div className={`${styles.wrapper} ${className ? className : ''}`}>
      <svg
        className={styles.svg}
        xmlns="http://www.w3.org/2000/svg"
        width="100%"
        height="auto"
        viewBox="0 0 1920 400"
        fill="none"
      >
        <path
          ref={pathRef}
          opacity="0.4"
          d="M1.29717 130.614C1.29717 130.614 69.5354 -10.3938 293.297 1.30623C517.059 13.0062 692.5 327.991 997 341.988C1301.5 355.986 1500 125.037 1660 111.037C1820 97.0372 1865 168.037 1865 168.037"
          stroke="url(#paint0_linear_3035_8938)"
        />
        <defs>
          <linearGradient
            id="paint0_linear_3035_8938"
            x1="43"
            y1="0.995615"
            x2="1917"
            y2="183.472"
            gradientUnits="userSpaceOnUse"
          >
            <stop offset="0.015518" stopOpacity="0.2" />
            <stop offset="0.0965764" stopColor="#E4D7F9" />
            <stop offset="0.404553" stopColor="#D6CAEA" stopOpacity="0.95157" />
            <stop offset="0.769516" stopColor="#FFF6AE" />
            <stop offset="0.964975" stopOpacity="0.2" />
          </linearGradient>
        </defs>
      </svg>

      {icons.map((src, i) => (
        <div
          key={i}
          className={styles.icon}
          ref={(el) => {
            if (el) iconRefs.current[i] = el
          }}
        >
          {iconMap[src]}
        </div>
      ))}
    </div>
  )
}

export default MovingIconsLine

const adwords = (
  <svg width="24" height="22" viewBox="0 0 24 22" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M0.558278 15.7107C0.238478 16.2676 0.0504879 16.8909 0.00884366 17.5325C-0.0328006 18.1741 0.0730166 18.8166 0.318113 19.4106C0.56321 20.0045 0.941019 20.5338 1.42233 20.9577C1.90364 21.3815 2.47555 21.6885 3.09384 21.8549C3.71213 22.0213 4.36024 22.0426 4.98804 21.9172C5.61585 21.7918 6.20654 21.5231 6.71443 21.1318C7.22233 20.7405 7.63382 20.2371 7.91709 19.6606C8.20036 19.0841 8.34782 18.4498 8.34807 17.8069C8.34843 16.8837 8.04539 15.9862 7.48598 15.2536C6.92657 14.5211 6.14207 13.9945 5.25424 13.7556C4.3664 13.5167 3.42488 13.5788 2.57578 13.9323C1.72668 14.2858 1.01749 14.9109 0.558278 15.7107Z" />
    <path d="M6.8247 4.80957L2.12891 12.9849C2.87363 12.6659 3.68203 12.5254 4.49014 12.5745C5.29826 12.6236 6.08392 12.8609 6.78496 13.2676C7.48601 13.6743 8.0832 14.2393 8.5293 14.9179C8.9754 15.5965 9.25816 16.37 9.35521 17.1773L11.4005 13.6137C7.51863 6.87436 6.95514 6.22977 6.8247 4.80957Z" />
    <path d="M23.4418 15.7105C23.1757 15.2598 15.5477 1.94351 15.3964 1.74961C14.7684 0.869913 13.8261 0.268249 12.7665 0.0705411C11.707 -0.127167 10.6123 0.0944032 9.71173 0.688881C8.81113 1.28336 8.17434 2.20467 7.93464 3.25999C7.69495 4.31532 7.87092 5.42286 8.42573 6.35083C8.37356 6.35083 8.16486 5.90014 16.2103 19.903C16.4844 20.3799 16.8493 20.7979 17.2842 21.1332C17.7191 21.4685 18.2155 21.7144 18.7451 21.857C19.2746 21.9996 19.827 22.036 20.3705 21.9642C20.9141 21.8924 21.4383 21.7137 21.9131 21.4384C22.3879 21.1632 22.8041 20.7966 23.1379 20.3598C23.4717 19.923 23.7166 19.4244 23.8585 18.8925C24.0005 18.3606 24.0368 17.8058 23.9653 17.2599C23.8938 16.7139 23.7159 16.1874 23.4418 15.7105Z" />
  </svg>
)

const linkedin = (
  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <g clipPath="url(#clip0_3012_1138)">
      <path d="M23.9977 23.9988L24.0037 23.9978V15.1958C24.0037 10.8898 23.0767 7.57275 18.0427 7.57275C15.6227 7.57275 13.9987 8.90075 13.3357 10.1598H13.2657V7.97475H8.49268V23.9978H13.4627V16.0638C13.4627 13.9748 13.8587 11.9548 16.4457 11.9548C18.9947 11.9548 19.0327 14.3388 19.0327 16.1978V23.9988H23.9977Z" />
      <path d="M0.39502 7.97656H5.37102V23.9996H0.39502V7.97656Z" />
      <path d="M2.88249 0C1.29149 0 0.000488281 1.291 0.000488281 2.882C0.000488281 4.473 1.29149 5.791 2.88249 5.791C4.47349 5.791 5.76449 4.473 5.76449 2.882C5.76349 1.291 4.47249 0 2.88249 0Z" />
    </g>
    <defs>
      <clipPath id="clip0_3012_1138">
        <rect width="24" height="24" transform="translate(0.000488281)" />
      </clipPath>
    </defs>
  </svg>
)

const meta = (
  <svg width="24" height="16" viewBox="0 0 24 16" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M23.9484 9.2422C23.9987 8.66175 23.3826 3.86046 20.8301 1.59547C19.5691 0.411108 18.4646 0 17.3347 0C16.1423 0 15.4924 0.320612 14.8262 0.759585C13.6255 1.4945 12.3098 3.33309 12.3098 3.33309C12.3098 3.33309 9.99609 0 6.86674 0C3.01859 0.000849231 1.15569 4.72584 1.15569 4.72584C1.15569 4.72584 1.15513 4.72698 1.1544 4.72831C1.15419 4.72877 1.15378 4.72956 1.15353 4.73002C1.15265 4.73181 1.15146 4.73399 1.14996 4.73693C1.1496 4.73764 1.14912 4.73849 1.14877 4.73935C1.14711 4.74248 1.1452 4.74634 1.14303 4.75055C1.14235 4.7519 1.14168 4.7533 1.14097 4.7547C1.13844 4.75965 1.13565 4.76536 1.13254 4.77162C1.13203 4.77266 1.13162 4.77349 1.1311 4.77453C1.11555 4.80601 1.09314 4.85275 1.06515 4.91391C1.06494 4.91448 1.06469 4.91499 1.06447 4.91554C1.05751 4.93077 1.05022 4.94687 1.04263 4.9639C1.04263 4.96398 1.04252 4.96401 1.04252 4.96409C0.879626 5.32864 0.572407 6.09768 0.333639 7.1765C0.333374 7.17751 0.333175 7.17862 0.332911 7.17963C0.322016 7.22882 0.311319 7.27866 0.300728 7.32915C0.300106 7.33219 0.299485 7.33513 0.298863 7.33817C0.289356 7.38358 0.280061 7.42966 0.270872 7.47608C0.269629 7.4823 0.268347 7.48828 0.267104 7.49459H0.267263C0.0297243 8.70157 -0.108026 10.2468 0.108701 12.0183C0.421646 14.5756 2.12603 15.8496 3.93686 15.9627C6.07505 16.1944 7.60723 14.7262 8.75194 13.0775C9.62694 11.8173 11.9845 7.47066 11.9845 7.47066L11.9845 7.47082C12.6742 8.61255 13.5119 9.99535 14.0351 10.8459C14.5167 11.6288 15.1594 12.8947 16.7186 14.6361C16.7507 14.6678 16.7829 14.6991 16.8153 14.73C16.8255 14.7399 16.8359 14.7496 16.8462 14.7594C16.8684 14.7804 16.8908 14.8015 16.9131 14.8222C16.9253 14.8335 16.9376 14.8446 16.9498 14.8558C16.9708 14.875 16.9918 14.8939 17.0129 14.9127C17.0255 14.924 17.038 14.9351 17.0507 14.9462C17.0723 14.9652 17.094 14.984 17.1157 15.0025C17.1276 15.0127 17.1395 15.023 17.1515 15.033C17.1774 15.0549 17.2035 15.0764 17.2297 15.0977C17.2374 15.1038 17.245 15.1103 17.2528 15.1165C17.2864 15.1437 17.3203 15.1702 17.3544 15.1963C17.3641 15.2037 17.3738 15.2108 17.3835 15.2181C17.4082 15.2367 17.4331 15.2553 17.4581 15.2735C17.4711 15.2829 17.4841 15.2921 17.4971 15.3013C17.5193 15.3171 17.5416 15.3326 17.5639 15.348C17.5778 15.3575 17.5918 15.367 17.6058 15.3763C17.628 15.3911 17.6504 15.4058 17.6728 15.4202C17.6866 15.4291 17.7003 15.4379 17.7142 15.4466C17.7389 15.462 17.7637 15.477 17.7886 15.4919C17.8003 15.4989 17.8119 15.5061 17.8236 15.513C17.8599 15.5342 17.8964 15.5548 17.9334 15.5748C17.941 15.5789 17.9487 15.5828 17.9564 15.5868C17.9861 15.6026 18.016 15.6183 18.0461 15.6333C18.0601 15.6403 18.0742 15.6469 18.0883 15.6537C18.1126 15.6654 18.1369 15.677 18.1615 15.6882C18.1771 15.6953 18.1927 15.7022 18.2084 15.7091C18.2322 15.7196 18.2561 15.7297 18.2801 15.7396C18.2961 15.7462 18.312 15.7528 18.3281 15.7591C18.3532 15.769 18.3786 15.7786 18.4042 15.788C18.4191 15.7934 18.4339 15.7991 18.449 15.8044C18.482 15.8161 18.5152 15.8271 18.5487 15.8377C18.5565 15.8402 18.5641 15.8429 18.5719 15.8453C18.6125 15.8579 18.6537 15.8697 18.6952 15.8809C18.7099 15.8848 18.7248 15.8884 18.7396 15.8921C18.7674 15.8992 18.7953 15.9061 18.8234 15.9126C18.8408 15.9164 18.8584 15.9201 18.876 15.9238C18.9023 15.9294 18.9287 15.9347 18.9553 15.9397C18.9736 15.9431 18.9919 15.9464 19.0104 15.9495C19.0374 15.9541 19.0648 15.9583 19.0922 15.9623C19.1101 15.9649 19.1281 15.9676 19.1462 15.9699C19.1776 15.974 19.2093 15.9774 19.2411 15.9807C19.2556 15.9822 19.2698 15.984 19.2843 15.9853C19.3299 15.9894 19.3761 15.9927 19.4227 15.9951C19.4372 15.996 19.452 15.9961 19.4666 15.9967C19.5 15.9981 19.5334 15.9993 19.5673 15.9998C19.5865 16.0001 19.6061 15.9999 19.6256 15.9999C19.6555 16 19.6856 15.9998 19.716 15.9991C19.7367 15.9986 19.7576 15.9979 19.7786 15.9972C19.8087 15.996 19.8391 15.9946 19.8697 15.9928C19.8907 15.9915 19.9117 15.9903 19.9328 15.9887C19.9657 15.9863 19.9991 15.9833 20.0324 15.9801C20.0516 15.9783 20.0704 15.9767 20.0897 15.9747C20.1407 15.9691 20.1923 15.9628 20.2445 15.9554C20.2453 15.9554 20.2461 15.9553 20.2468 15.9552V15.9551C20.5388 15.9138 20.8496 15.8436 21.1822 15.7407C24.1932 14.6349 24.0804 10.1443 23.9484 9.2422ZM6.63906 11.9692C6.0391 12.7145 5.16586 13.5291 4.28275 13.405C2.69846 13.1824 2.31826 11.5289 2.57176 9.17588C2.62708 8.66227 2.73528 8.08661 2.89364 7.494C2.89602 7.48514 2.8985 7.4762 2.90093 7.46725C2.90889 7.43773 2.91694 7.40816 2.92515 7.37856C2.92919 7.36394 2.93331 7.34938 2.9374 7.33476C2.94431 7.31018 2.95135 7.28557 2.95842 7.261C2.96271 7.24591 2.9671 7.23083 2.97149 7.21575C2.97923 7.18893 2.98723 7.16207 2.99525 7.13526C2.99886 7.12329 3.00232 7.1113 3.006 7.09926C3.01726 7.06193 3.02878 7.02448 3.0404 6.98709C3.04438 6.97439 3.04845 6.96164 3.05248 6.94897C3.06075 6.9227 3.06907 6.89644 3.07754 6.8702C3.08245 6.85504 3.08735 6.83988 3.09231 6.82472C3.10047 6.79976 3.10873 6.77472 3.11705 6.74977C3.1218 6.73549 3.12656 6.72124 3.13136 6.70701C3.14282 6.67296 3.15449 6.63892 3.16628 6.60493C3.16901 6.59707 3.1717 6.58929 3.17443 6.58154C3.18647 6.54695 3.19876 6.51242 3.21115 6.47795C3.21616 6.4639 3.22128 6.44997 3.22633 6.43597C3.23547 6.41078 3.24472 6.38553 3.25407 6.36032C3.25955 6.34555 3.26507 6.3307 3.27065 6.31592C3.28057 6.28949 3.29059 6.26312 3.30071 6.23669C3.3054 6.22443 3.31005 6.21207 3.3148 6.19984C3.32927 6.16232 3.34398 6.12492 3.35886 6.08765C3.36304 6.07715 3.36733 6.06666 3.37156 6.05624C3.38278 6.02828 3.39408 6.00034 3.40555 5.97253C3.41138 5.95835 3.41727 5.9442 3.42311 5.93008C3.43354 5.90501 3.44402 5.88005 3.45461 5.85513C3.46044 5.84145 3.46624 5.82776 3.47207 5.81408C3.48529 5.78327 3.49862 5.75257 3.51209 5.72192C3.51524 5.7148 3.51829 5.7077 3.52139 5.70069C3.53776 5.66371 3.55434 5.6269 3.57102 5.59013C3.57655 5.578 3.58223 5.56588 3.58781 5.55378C3.5996 5.52811 3.61147 5.50254 3.6235 5.47701C3.62981 5.46348 3.63621 5.45004 3.64256 5.43658C3.65485 5.41077 3.66719 5.38503 3.6797 5.35933C3.68533 5.3478 3.69086 5.33624 3.69649 5.32473C3.71426 5.28855 3.73212 5.25248 3.75025 5.21664C3.75391 5.20941 3.75764 5.20229 3.76136 5.19505C3.77613 5.16595 3.79111 5.13687 3.80614 5.10795C3.8127 5.09539 3.81936 5.08284 3.82598 5.07024C3.83874 5.04599 3.85164 5.02181 3.86461 4.99778C3.87133 4.98529 3.87805 4.97282 3.88485 4.96031C3.89994 4.93258 3.91517 4.90503 3.93056 4.87751C3.9349 4.86965 3.93918 4.86182 3.94357 4.85405C3.963 4.81938 3.98272 4.78493 4.00266 4.75069C4.0084 4.74074 4.01434 4.73082 4.02017 4.72084C4.03474 4.69599 4.04941 4.67124 4.06418 4.64658C4.07136 4.63461 4.07859 4.62263 4.08587 4.61066C4.10029 4.58695 4.11484 4.56327 4.12941 4.53983C4.13602 4.52918 4.14258 4.51854 4.14925 4.50796C4.17016 4.47468 4.19119 4.44156 4.21246 4.40883C4.21442 4.40587 4.21634 4.403 4.21829 4.40004C4.23782 4.37003 4.25755 4.34028 4.27738 4.31078C4.28451 4.30023 4.29164 4.28987 4.29876 4.27937C4.31394 4.25697 4.3293 4.23469 4.34474 4.21259C4.35238 4.20165 4.36008 4.19067 4.36772 4.17977C4.38451 4.15598 4.40145 4.13245 4.41844 4.10902C4.42423 4.10109 4.42996 4.093 4.43575 4.08507C4.45832 4.05428 4.48099 4.02388 4.50392 3.99374C4.50955 3.98632 4.51533 3.97902 4.52097 3.97158C4.53863 3.94857 4.55645 3.92571 4.57426 3.90306C4.58226 3.89302 4.59022 3.88307 4.59824 3.87307C4.61471 3.85243 4.63135 3.83199 4.64803 3.8117C4.65573 3.80239 4.66337 3.79299 4.67112 3.78378C4.69323 3.75727 4.71544 3.73101 4.73785 3.70517C4.73977 3.70292 4.74172 3.70058 4.74364 3.69835C4.76792 3.67043 4.79241 3.64296 4.81704 3.61578C4.82463 3.60743 4.83227 3.59919 4.83987 3.5909C4.85748 3.57175 4.8752 3.55269 4.89303 3.5339C4.90159 3.52485 4.91018 3.51585 4.9188 3.50685C4.93733 3.48762 4.95603 3.46857 4.97478 3.4497C4.98175 3.44268 4.98873 3.43553 4.99575 3.42847C5.02132 3.40318 5.04699 3.37822 5.07286 3.35372C5.07788 3.3489 5.08299 3.34431 5.08804 3.33958C5.10917 3.31978 5.13034 3.30026 5.15168 3.28103C5.16041 3.2732 5.16914 3.26548 5.17782 3.25773C5.19641 3.24133 5.21502 3.22513 5.23375 3.20911C5.24248 3.20164 5.25121 3.19419 5.26004 3.18679C5.2825 3.1679 5.30513 3.14935 5.3278 3.13113C5.33235 3.12751 5.33679 3.12377 5.34133 3.12017C5.36845 3.09863 5.39576 3.07764 5.42324 3.05703C5.43099 3.05121 5.43884 3.04556 5.44664 3.03977C5.46678 3.02492 5.48709 3.01022 5.50753 2.99584C5.51699 2.98918 5.52644 2.98254 5.53589 2.97604C5.55608 2.96209 5.57643 2.94844 5.59678 2.93504C5.60515 2.92954 5.61347 2.92392 5.62184 2.91856C5.6502 2.90021 5.67866 2.88233 5.70737 2.86499C5.71094 2.86284 5.7145 2.86086 5.71812 2.85871C5.74338 2.84363 5.7689 2.82891 5.79446 2.81463C5.80375 2.80939 5.8131 2.80438 5.8225 2.79929C5.84306 2.78809 5.86377 2.77708 5.88453 2.76642C5.89429 2.76137 5.90406 2.75631 5.91392 2.75142C5.93722 2.73975 5.96071 2.72846 5.98421 2.71749C5.99077 2.71441 5.99722 2.71118 6.00378 2.70824C6.03369 2.69458 6.06374 2.68149 6.09401 2.66892C6.1016 2.66574 6.10934 2.66286 6.11699 2.65975C6.13997 2.65043 6.16305 2.64145 6.18619 2.63283C6.19647 2.62902 6.20675 2.62529 6.21703 2.62163C6.23898 2.6138 6.26087 2.60632 6.28298 2.59909C6.29254 2.59598 6.30209 2.59272 6.3117 2.5897C6.34284 2.57991 6.37415 2.57051 6.4056 2.56195C8.62359 1.95781 10.8159 5.53273 10.8159 5.53273C10.6969 5.75451 7.77752 10.6649 6.63906 11.9692ZM20.2464 13.4154C20.1654 13.4303 20.0805 13.4399 19.9917 13.4437C19.9908 13.4438 19.9899 13.4438 19.9891 13.4438C19.9677 13.4446 19.9461 13.4453 19.9242 13.4455C19.9208 13.4455 19.9173 13.4454 19.9139 13.4455C19.8945 13.4455 19.8749 13.4456 19.8552 13.4451C19.8479 13.4449 19.8405 13.4445 19.8332 13.4442C19.817 13.4437 19.8009 13.4433 19.7845 13.4424C19.7606 13.4411 19.7365 13.4395 19.7121 13.4374C18.935 13.2848 17.9792 12.3589 16.6779 10.1895C15.7755 8.67012 14.6402 6.89153 13.7533 5.52659C13.5349 5.19714 13.4105 5.01427 13.4105 5.01427C13.4105 5.01427 13.4123 5.01155 13.4149 5.00751C13.4692 4.923 14.0779 3.98311 14.8784 3.09005C16.6077 1.16062 18.4996 2.3852 18.9741 2.72789C19.8266 3.34366 20.542 4.63945 21.051 6.11022C21.3342 6.92884 21.7612 8.45529 21.7612 10.5986C21.7612 11.9102 21.3936 13.2036 20.2464 13.4154Z" />
  </svg>
)

const tiktok = (
  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M21.8571 6.07674C21.8366 6.07674 19.7631 6.03488 17.9965 4.7093C16.455 3.55814 15.923 1.05349 15.8412 0.125582V0H12.0897V16.5558C12.0897 18.5442 10.5073 20.1628 8.5634 20.1628C6.61948 20.1628 5.03707 18.5442 5.03707 16.5558C5.03707 14.5674 6.61948 12.9488 8.5634 12.9488H9.75022V9.11163H8.5634C4.55279 9.11163 1.28564 12.4535 1.28564 16.5558C1.28564 20.6581 4.55279 24 8.5634 24C12.574 24 15.8412 20.6581 15.8412 16.5558V7.84884C18.5626 9.85116 21.5092 9.91395 21.8503 9.91395V6.07674H21.8571Z" />
  </svg>
)
